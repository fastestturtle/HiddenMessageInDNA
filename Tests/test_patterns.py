from unittest import TestCase
from Code import patterns
from Code import common


class TestPatterns(TestCase):

    def test_countPatternNormal(self):
        genome = common.readGenomeSequenceFromFile('../Inputs/patternCountInput.txt')
        pattern = 'TGAAGGTTG'
        count = patterns.countPattern(genome, pattern)

        assert(count == 25)

    def test_findPatterns(self):
        genome = common.readGenomeSequenceFromFile('../Inputs/findPatternInput.txt')
        pattern = 'GCCCATCGC'

        indexes = patterns.findPattern(genome, pattern)
        output = '39 60 67 143 200 215 222 260 307 381 451 458 481 499 514 540 593 661 685 700 716 731 738 786 879 902 928 935 1006 1049 1112 1128 1212 1242 1278 1288 1295 1310 1326 1341 1371 1427 1443 1473 1535 1610 1646 1653 1660 1683 1735 1760 1767 1782 1877 1924 1931 1938 1960 2006 2026 2033 2040 2084 2149 2201 2219 2249 2271 2311 2346 2361 2370 2394 2463 2470 2477 2598 2670 2677 2684 2702 2744 2759 2778 2785 2978 2991 3008 3041 3057 3124 3162 3185 3221 3248 3276 3311 3346 3452 3459 3474 3490 3513 3541 3602 3609 3657 3709 3791 3809 3816 3823 3895 3902 3953 4005 4012 4019 4067 4074 4156 4163 4211 4288 4306 4333 4402 4463 4548 4606 4613 4620 4642 4672 4691 4711 4749 4758 4786 4793 4800 4834 4873 4880 4907 4928 4935 5017 5141 5158 5225 5277 5308 5315 5322 5337 5352 5359 5372 5540 5555 5571 5578 5616 5649 5802 5837 5869 5878 5924 5931 5995 6052 6059 6066 6112 6139 6174 6245 6252 6263 6296 6332 6339 6346 6359 6380 6423 6470 6483 6490 6501 6522 6529 6603 6683 6760 6812 6891 6898 6905 6927 6941 6948 6980 6987 7035 7071 7078 7140 7147 7169 7202 7218 7244 7299 7306 7484 7521 7538 7553 7582 7675 7701 7708 7731 7750 7757 7796 7856 7898 7905 7933 7950 7960 7979 7994 8026 8061 8068 8084 8091 8149 8156 8163 8195 8267 8371 8415 8586 8611'

        assert common.arraytoSpaceSeparatedValues(indexes) == output
